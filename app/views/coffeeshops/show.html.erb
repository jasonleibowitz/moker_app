<!-- <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' /> -->

<script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.css' rel='stylesheet' />

<div class="row">
  <div class="big-space"></div>
</div>

<div class="row">
  <div class="small-8 small-centered columns detail-wrap">
    <div class="small-8 columns">
      <h1 class="title"><%= @coffee_shop.name %></h1>
    </div>
    <div class="row">
      <div class="small-4 columns">
        <div class="circle">
          <p class="circle-rating"><%= @coffee_shop.rating %></p>
        </div>
      </div>
    </div>
    <div class="small-6 columns ratings">
      <p><span title="Coffee Quality Rating"><i class="fa fa-coffee"></i> - <%= @coffee_shop.coffee_rating %></span> &nbsp;
         <span title="WiFi Signal Quality Rating"><i class="fa fa-signal"></i> - <%= @coffee_shop.wifi_rating %></span> &nbsp;
         <span title="Workspace Availability Rating"><i class="fa fa-desktop"></i> - <%= @coffee_shop.workspace_rating %></span> &nbsp;
         <span title="Power Outlet Availability Rating"><i class="fa fa-power-off"> </i> - <%= @coffee_shop.outlet_rating %></span></p>
    </div>
    <div class="row">
      <div class="small-4 small-offset-1 columns rate-button">
        <%= link_to 'Rate', root_path, class: 'button ' %>
      </div>
    </div>
    <div class="row">
      <div class="small-8 small-centered columns tips">
        <div class="small-6 columns">
          <h6 class="tip-title">Tips:</h6>
        </div>
        <div class="small-4 small-offset-2 columns tip-button">
          <%= link_to "Leave a Tip", root_path, class: "button tiny radius"  %>
        </div>
        <hr>
        <% @coffee_shop.foursquare_reviews.each do |foursquare_review| %>
          <p class="tip-comment"><%= foursquare_review.comment %></p>
            <div class="small-2 columns">
              <div class="review-avatar-wrap"><img class="review-avatar" src="<%= foursquare_review.user_pic %>"></div>
            </div>
            <div class="small-7 columns">
              <p class="tip-username"><%= foursquare_review.username %> | <%= foursquare_review.created_at.strftime "%B %e, %Y" %></p>
            </div>
          <hr>
        <% end %>
      </div>
    </div>
    <div class="row">
      <div class="small-8 small-centered columns">
        <style> #map { position:relative; top:25px; bottom:0; width:100%; height:400px; } </style>
        <div id="map"></div>
        <script>
          var map = L.mapbox.map('map', 'jasonleibowitz.i7i19hk9')
            .setView([<%= @coffee_shop.lat %>, <%= @coffee_shop.lon %>], 15);

              L.mapbox.featureLayer({
              // this feature is in the GeoJSON format: see geojson.org
              // for the full specification
              type: 'Feature',
              geometry: {
                  type: 'Point',
                  // coordinates here are in longitude, latitude order because
                  // x, y is the standard for GeoJSON and many formats
                  coordinates: [<%= @coffee_shop.lon %>, <%= @coffee_shop.lat %>]
              },
              properties: {
                  title: '<%= @coffee_shop.name %>',
                  description: '<%= @coffee_shop.address %>',
                  // one can customize markers by adding simplestyle properties
                  // http://mapbox.com/developers/simplestyle/
                  'marker-size': 'large',
                  'marker-color': '#008CBA',
                  'marker-symbol': 'cafe'
              }
          }).addTo(map);
        </script>
      </div>
    </div>
    <div class="row">
      <div class="big-space"></div>
    </div>
  </div>
</div>

